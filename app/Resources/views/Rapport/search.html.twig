{% extends 'base.html.twig' %}

{% block title %} Opportunités d'affaires {% endblock %}
{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('bower_components/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css') }}">
{% endblock %}
{% block body %}
    <h1>Liste des opportunités d'affaires</h1>
    <hr>

    <h3>Recherche par période</h3>
    <div class="row">
        <div class="col-md-4 pull-right">
            <a href="{{ path('Rapport_list') }}" class="btn btn-default"><i class="fa fa-arrow-left"></i> Retour au dashboard</a>
        </div>
        <div class="col-md-8">
            {{ form_start(search_form) }}
            <div class="form-inline">
                {{ form_row(search_form.startDate) }}
                {{ form_row(search_form.endDate) }}
                {{ form_row(search_form.submit) }}
            </div>
            {{ form_end(search_form) }}
        </div>
    </div><br><br>

    <table class="table table-striped table-bordered">
        <thead>
        <tr>
            <th>Id</th>
            <th>Nom du projet</th>
            <th>Client</th>
            <th>Type</th>
            <th>Probabilité</th>
            <th>État</th>
            <th>Total</th>
            <th>Date Echéance</th>
            {#<th>Actions</th>#}
        </tr>
        </thead>
        <tbody>
        {% for opportunity in opportunities %}
            <tr>
                <td>{{ opportunity.id }}</td>
                <td>{{ opportunity.label }}</td>
                <td>{{ opportunity.customer.nom }}</td>
                <td>{{ opportunity.type }}</td>
                <td>
                    {% set val = opportunity.probability ? opportunity.probability.value : 0  %}
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" aria-valuenow="{{ val }}"
                             aria-valuemin="0" aria-valuemax="100" style="width:{{ val }}%">
                            {{ val }}%
                        </div>
                    </div>
                </td>
                <td>{{ opportunity.status }}</td>
                <td class="pull text-right">{{ opportunity.total|number_format(2, ',', ' ') }}</td>
                <td>{{ opportunity.dateEcheance | date('d/m/Y') }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bower_components/moment/min/moment.min.js') }}"></script>

    <script
        src="{{ asset('bower_components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js') }}">
    </script>

    {% include 'datetime_picker.html.twig' %}

{% endblock %}
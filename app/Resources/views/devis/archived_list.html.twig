{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}

    <link href="{{ asset('css/jquery.dataTables.min.css') }}" rel="stylesheet"/>
{% endblock %}
{% block title %} Liste des devis archivés{% endblock %}
{% block body %}
    <div class="row">
        <h1>Liste des devis Archivés</h1>
    </div>
    <div class="row">
        <div class="col-lg-12">

            <a href="{{ url('devis_list') }}" class="btn btn-default">
                <i class="fa fa-arrow-left" aria-hidden="true"></i> Retour à la liste des devis
            </a>

            <hr>
            <table id="liste_devis" class="table table-striped table-bordered">
                <thead>
                <tr>
                    <th>#</th>
                    <th>Client</th>
                    <th>Statut</th>
                    <th>Titre <span class="badge">nombre de produits</span></th>
                    <th>Date de modification</th>
                    <th>Commercial</th>
                    <th>Total H.T.</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                {% for chaque_devis in devis %}
                    {% if chaque_devis.archived %}
                        <tr>
                            <th scope="row">{{ chaque_devis.reference }} </th>
                            <td><strong>{{ chaque_devis.client.nom }} </strong></td>
                            <td>{% if chaque_devis.estCommande %} Commande {% elseif chaque_devis.draft %} Devis {% else %} Publié {% endif %}</td>
                            <td>{{ chaque_devis.titre }} <span
                                        class="badge">{{ chaque_devis.abstractProduits |length }}</span></td>
                            <td>{{ chaque_devis.datemodification |localizeddate('none', 'none', 'fr_FR', null, "d MMMM Y") }} </td>
                            {% if chaque_devis.commercial %}
                                <td>{{ chaque_devis.commercial.prenom }} {{ chaque_devis.commercial.nom }} </td>
                            {% else %}
                                <td> NULL</td>
                            {% endif %}
                            <td align="right">
                                <strong>{{ chaque_devis.totalht | number_format(2, ',', ' ') }} {{ chaque_devis.deviseVente.symbol }} </strong>
                            </td>
                            <td style="width:300px; vertical-align:middle;">

                                <a type="button" class="btn btn-info btn-block"
                                   href="{{ url('devis_archive', {'id' : chaque_devis.id}) }}"><i class="fa fa-file-archive-o"
                                                                                                  aria-hidden="true"></i>
                                    {{ 'Désarchiver' }}</a>
                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}
                </tbody>
            </table>
            <hr>


        </div>
    </div>
    <br><br><br><br><br><br><br><br><br><br><br><br><br><br>
{% endblock %}

{% block javascripts %}

    {{ parent() }}
    <script src="{{ asset('js/jquery.dataTables.min.js') }}"></script>
    <script>
        $(document).ready(function () {
            $('#liste_devis').DataTable({
                "pageLength": 50,
                "aaSorting": []
            });
        });
        $.extend($.fn.dataTableExt.oStdClasses, {
            "sFilterInput": "form-control",
            "sLengthSelect": "form-control"
        });
    </script>

{% endblock %}

